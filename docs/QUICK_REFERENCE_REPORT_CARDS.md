# Report Cards - Quick Reference Guide

## ðŸŽ¯ Complete Flow (One Page)

```
TEACHER WORKFLOW                           SYSTEM PROCESSING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ðŸ“ ENTER SCORES                            ðŸ’¾ SAVE TO DATABASE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Scores > Select:     â”‚                â”‚ Collection: scores  â”‚
â”‚    â€¢ Class (Year 1A)    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â€¢ classId           â”‚
â”‚    â€¢ Subject (Math)     â”‚                â”‚ â€¢ subjectId         â”‚
â”‚    â€¢ Term (auto-select) â”‚                â”‚ â€¢ termId            â”‚
â”‚                         â”‚                â”‚ â€¢ studentId         â”‚
â”‚ 2. Enter for each:      â”‚                â”‚ â€¢ total: 86         â”‚
â”‚    â€¢ CA1: 9/10         â”‚                â”‚ â€¢ grade: "A1"       â”‚
â”‚    â€¢ CA2: 8/10         â”‚                â”‚ â€¢ isPublished: true â”‚
â”‚    â€¢ CA3: 9/10         â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    â€¢ Exam: 60/70       â”‚
â”‚    = Total: 86/100     â”‚
â”‚    = Grade: A1         â”‚
â”‚                         â”‚
â”‚ 3. Click "Publish"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                â¬‡

ðŸ“Š VIEW RESULTS                            ðŸ” QUERY & CALCULATE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Results > Select:    â”‚                â”‚ Load published:     â”‚
â”‚    â€¢ Term               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ â€¢ All scores        â”‚
â”‚    â€¢ Class (Year 1A)    â”‚                â”‚ â€¢ Students          â”‚
â”‚                         â”‚                â”‚                     â”‚
â”‚ 2. See:                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Calculate:          â”‚
â”‚    â€¢ Rankings (1st-20th)â”‚                â”‚ â€¢ Class average     â”‚
â”‚    â€¢ Averages           â”‚                â”‚ â€¢ Student ranks     â”‚
â”‚    â€¢ Grades             â”‚                â”‚ â€¢ Totals            â”‚
â”‚                         â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ 3. Click:               â”‚
â”‚    â€¢ "Download All (20)"â”‚
â”‚    â€¢ or "View Details"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                â¬‡

ðŸ“„ GENERATE PDF                            ðŸŽ¨ TEMPLATE SYSTEM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Single or Bulk Download â”‚                â”‚ 1. Find Template:   â”‚
â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚    âœ“ Class assigned â”‚
â”‚                         â”‚                â”‚    âœ“ Level assigned â”‚
â”‚                         â”‚                â”‚    âœ“ Default        â”‚
â”‚                         â”‚                â”‚    âœ“ Legacy fallbackâ”‚
â”‚                         â”‚                â”‚                     â”‚
â”‚                         â”‚                â”‚ 2. Load Data:       â”‚
â”‚                         â”‚                â”‚    â€¢ Student info   â”‚
â”‚                         â”‚                â”‚    â€¢ All scores     â”‚
â”‚                         â”‚                â”‚    â€¢ Attendance     â”‚
â”‚                         â”‚                â”‚    â€¢ School logo    â”‚
â”‚                         â”‚                â”‚                     â”‚
â”‚                         â”‚                â”‚ 3. Apply Styling:   â”‚
â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚    â€¢ Colors         â”‚
â”‚ "James_Thompson_        â”‚                â”‚    â€¢ Fonts          â”‚
â”‚  First_Term_2025_       â”‚                â”‚    â€¢ Layout         â”‚
â”‚  Report.pdf"            â”‚                â”‚    â€¢ Sections       â”‚
â”‚                         â”‚                â”‚                     â”‚
â”‚ âœ… Downloaded!          â”‚                â”‚ 4. Generate PDF     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸš€ Quick Start Guide

### For Teachers

**Enter Scores (5 minutes)**
1. Dashboard â†’ **Scores**
2. Select: Class + Subject + Term *(current term auto-selected)*
3. Enter CA1, CA2, CA3, Exam for each student
4. Click **"Publish Scores"**

**Generate Report Cards (30 seconds)**
1. Dashboard â†’ **Results**
2. Select: Term + Class
3. Click **"Download All (X)"**
4. PDFs download automatically

### For Admins

**Create Template (10 minutes)**
1. Dashboard â†’ Settings â†’ **Report Cards**
2. Click **"Create New Template"**
3. Use wizard to customize:
   - Colors, fonts, logo position
   - Enable/disable sections
   - Show/hide CA breakdown
4. Click **"Save Template"**

**Assign Template (2 minutes)**
1. Settings â†’ Report Cards â†’ **"Assign"**
2. Choose: Specific classes OR Class levels
3. Click **"Save Assignment"**

---

## ðŸ“‹ Key URLs

| Page | URL | Purpose |
|------|-----|---------|
| Score Entry Setup | `/dashboard/scores` | Select class/subject/term |
| Enter Scores | `/dashboard/scores/entry` | Enter CA1, CA2, CA3, Exam |
| View Results | `/dashboard/results` | Select term/class |
| Class Results | `/dashboard/results/class/[id]/[term]` | Download reports |
| Template Manager | `/dashboard/settings/report-cards` | Create/manage templates |
| Template Builder | `/dashboard/settings/report-cards/builder/[id]` | Customize template |
| Assign Template | `/dashboard/settings/report-cards/assign/[id]` | Assign to classes |

---

## ðŸ”‘ Key Concepts

### Published vs Draft Scores
- **Draft** (`isDraft: true`): Saved but not visible in results
- **Published** (`isPublished: true`): Visible in results, used for PDFs
- **Toggle**: Edit and re-publish to update

### Template Priority
```
1. Direct â†’ Template assigned to specific class
2. Level  â†’ Template assigned to class level (e.g., "Year 1")
3. Default â†’ School's default template
4. Legacy  â†’ Static fallback
```

### CA Breakdown
- **Shown**: CA1 (9) + CA2 (8) + CA3 (9) + Exam (60) = 86
- **Hidden**: Total (86) + Grade (A1) only

### Grading Scale
| Grade | Score Range | Description |
|-------|-------------|-------------|
| A1 | 75-100 | Excellent |
| B2 | 70-74 | Very Good |
| C4 | 60-69 | Good |
| C6 | 50-59 | Credit |
| D7 | 45-49 | Pass |
| E8 | 40-44 | Pass |
| F9 | 0-39 | Fail |

---

## âš™ï¸ System Requirements

### Firestore Collections
```
âœ“ students     - Student records
âœ“ classes      - Class information
âœ“ subjects     - Subject list
âœ“ terms        - Academic terms
âœ“ scores       - Student scores (PUBLISHED)
âœ“ attendance   - Attendance records
âœ“ reportCardTemplates - PDF templates
âœ“ tenants      - School branding
```

### Required Indexes
```javascript
// scores collection
{
  tenantId + classId + subjectId          // Load existing scores
  tenantId + classId + termId + isPublished  // Results query
  tenantId + studentId + termId + isPublished // Student results
}

// reportCardTemplates collection
{
  tenantId + assignedToClasses + isActive  // Find by class
  tenantId + assignedToLevels + isActive   // Find by level
  tenantId + isDefault + isActive          // Find default
}
```

---

## ðŸŽ¨ Template Customization Options

### Layout
- **Page Size**: A4, Letter
- **Orientation**: Portrait, Landscape
- **Margins**: Top, Bottom, Left, Right (in points)
- **Color Scheme**: Primary (blue), Grayscale, Custom
- **Font Size**: Small, Medium, Large

### Branding
- **Logo**: Show/hide, position (left/center/right)
- **School Name**: Always shown in header
- **Motto**: Optional tagline
- **Address**: School contact information

### Sections (enable/disable/reorder)
1. Header - School branding
2. Student Info - Name, class, term
3. Scores Table - Subject scores
4. Summary - Totals, average, grade
5. Attendance - Days present/absent
6. Comments - Teacher + principal
7. Footer - Dates, signatures

### Scores Table Options
- **Show CA Breakdown**: Display CA1, CA2, CA3 columns
- **Show Position**: Display student rank
- **Show Grade**: Display letter grade
- **Show Percentage**: Display percentage

---

## ðŸ› Common Issues

### "0 students" in Results
**Fix**: Ensure students have `currentClassId` set to the class

### Duplicate Scores
**Fix**: System now auto-loads and updates existing scores (v2.0+)

### Wrong Term Selected
**Fix**: System auto-selects current term + shows warning if changed

### PDF Not Generating
**Check**:
1. Scores are published (not draft)
2. Student exists in class
3. Template is active
4. All required data loaded

### Template Not Applied
**Check**:
1. Template assignment (class/level)
2. Template is active (`isActive: true`)
3. Only one default template
4. Clear browser cache

---

## ðŸ“Š Data Flow Summary

```
INPUT                  PROCESS                OUTPUT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Scores Entry      â†’    Save to Firestore   â†’  scores collection
                       Calculate totals        (isPublished: true)

View Results      â†’    Query published     â†’  Rankings table
                       scores + students       Class statistics

Download PDF      â†’    Load template       â†’  Customized PDF
                       Load all data           Professional report
                       Apply styling           School branding
                       Generate PDF            Student-specific
```

---

## ðŸ’¡ Best Practices

### Entering Scores
âœ… Enter for ONE subject at a time (less confusion)
âœ… Use "Save as Draft" to save progress
âœ… Click "Publish" when all students complete
âœ… Check current term is selected (auto-selected)

### Creating Templates
âœ… Start with a preset (Classic/Modern/Compact)
âœ… Test with sample data before assigning
âœ… Keep one template as default
âœ… Use descriptive names (e.g., "Primary School - Colorful")

### Assigning Templates
âœ… Assign by level for consistency (all Year 1 classes)
âœ… Use specific class assignment for special cases
âœ… Only activate templates when ready to use
âœ… Keep old templates inactive (don't delete)

### Generating PDFs
âœ… Generate during off-peak hours (faster)
âœ… Test single PDF before bulk download
âœ… Check attendance data is up-to-date
âœ… Add teacher/principal comments for complete reports

---

## ðŸ”— Related Documentation

- [Full Flow Diagram](./SCORE_TO_REPORT_CARD_FLOW.md)
- [Score Entry Improvements](../SCORE_ENTRY_IMPROVEMENTS.md)
- [Template Builder Story](./stories/report-card-template-builder.story.md)
- [Results Debugging](../RESULTS_DEBUG_CHECKLIST.md)

---

## ðŸ“ž Support

**Issues?** Check:
1. Browser console for errors
2. Firestore indexes deployed
3. Student data complete
4. Scores published (not draft)

**Still stuck?** File an issue with:
- Screenshots
- Console errors
- Step-by-step what you did
